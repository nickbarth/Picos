pico-8 cartridge // http://www.pico-8.com
version 18
__lua__
-- init

function _init()
  poke(0x5f2c, 3)
  
  step=0
  gravity=0.3
  friction=0.85
  debug=""
end

function _update()
 step+=1
 game_update()
end

function _draw()
  cls()
  map(0,0,0,0,8,8)
  game_draw()
  
  print(debug)
end

-->8
-- menu
-->8
-- game

function game_update()
  player_update()
  axes_update()
end

function game_draw()
  player_draw()
  axes_draw()
end
-->8
-- player

player = {
  x=0,
  y=48,
  dx=0,
  dy=0,
  max_dx=2,
  max_dy=3,
  accl=0.3,
  boost=3,
  jumping=false
}

function player_update()
  player.dy+=gravity
  player.dx*=friction
  
  if btn(⬅️) then
    player.dx-=player.accl
  elseif btn(➡️) then
    player.dx+=player.accl
  end
    
  -- jump
  if (btnp(⬆️) or btnp(❎))
   and not player.jumping then
    player.dy-=player.boost
    player.jumping=true
  end
  
  -- attack
  if btnp(🅾️) then
    add_axe()    
  end
  
  -- apply movement
  player.x+=player.dx
  player.y+=player.dy
  
  -- ground
  if player.y > 48 then
    player.y=48
    player.dy=0
    player.jumping=false
  end
end

function player_draw()
  spr(1, player.x, player.y)
end

-->8
-- axe
axes={}

function add_axe()
  limit=2
  
  -- limit axes
  if count(axes) >= limit then
    return
  end
  
  axe={
    f=43,
    cf=0,
    x=player.x,
    y=player.y,
    dx=player.dx,
    dy=0,
    angle=0.10
  }
  
  add(axes, axe)
end

function axes_update()
  for axe in all(axes) do
    
    -- axe movemovement
    axe.y+=sin(axe.angle)*2
    axe.x+=1+axe.dx

    -- trajectory
    if axe.angle < 0.80 then
     axe.angle+=0.05
    end
    
    -- animation
    if step % 3 == 0 then
      axe.cf=(axe.cf+1)%4
    end
    
    -- remove axe
    if axe.y > 64 then
      del(axes, axe)
    end
  end
end

function axes_draw()
  for axe in all(axes) do
    spr(43+axe.cf, axe.x, axe.y)
  end
end
__gfx__
000000000aaaaaa00aaaaaa000000000333333330044999999994400ccccccccb333333bb333333bb333333b0003300000000000000000000000000000000000
00000000aaaaaaa0aaaaaaa00aaaaaa0bb9bb9bb0044999999994400cccccccc333bbbb33bbbbbb33bbbb3330033330000000000000000000000000000000000
00700700aaafcf00aaafcf00aaaaaaa0b999999b0044999999994400cccccccc33bbbbbbbbbbbbbbbbbbbb330999999000000000000000000000000000000000
00077000aaffcf00aaffcf00aaafcf00999999990044999999994400cccccccc3bbbbbbbbbbbbbbbbbbbbbb30999999000000000000000000000000000000000
000770000ffffe000ffffe00aaffcf00944444490044999999994400cccccccc3bbbbbbbbbbbbbbbbbbbbbb30099990000000000000000000000000000000000
00700700ffffffff0ffff0000ffffe00444444440044999999994400cccccccc3bbbbbbbbbbbbbbbbbbbbbb30099990000000000000000000000000000000000
00000000033330000f33300003333ff0444444440044999999994400cccccccc3bbbbbbbbbbbbbbbbbbbbbb30009900000000000000000000000000000000000
00000000f333ff000ff3f0000f3ff000444444440044999999994400ccccccccb3bbbbbbbbbbbbbbbbbbbb3b0000000000000000000000000000000000000000
bbbbbbbb000000000000000006666660000000004444999999994444c333333cb3bbbbbbbbbbbbbbbbbbbb3bb333333bb333333bb333333b0000000000000000
333333330000000000000000677777760066660044449999999944443bbbbbb33bbbbbbbbbbbbbbbbbbbbbb33333333333333333333333330000000000000000
39999993000000000008888067777776067777604444999999994444bbbbbbbb3bbbbbbbbbbbbbbbbbbbbbb33333333333333333333333330000000000000000
99999999000888800028222867777776067777604444999999994444bbbbbbbb3bbbbbbbbbbbbbbbbbbbbbb33333333333333333333333330000000000000000
94444449208822280282888867777776067777604444999999994444bbbbbbbb3bbbbbbbbbbbbbbbbbbbbbb33333333333333333333333330000000000000000
44444444028288880282828867777776067777604444999999994444bbbbbbbb3bbbbbbbbbbbbbbbbbbbbbb33333333333333333333333330000000000000000
4444444402828288ff82282867777776006666004444999999994444bbbbbbbb3bbbbbbbbbbbbbbbbbbbbbb33333333333333333333333330000000000000000
44444444ff822828ff88888806666660000000004444999999994444bbbbbbbbb3bbbbbbbbbbbbbbbbbbbb3b3333333b3333333b3333333b0000000000000000
00000000003333000033330000000000000000004449999999999444b333333bb3bbbbbbbbbbbbbbbbbbbb3b0006000000006000000000000000000000000000
055555500323333003233330000000000000000044499999999994443bbbbbb33bbbbbbbbbbbbbbbbbbbbbb30066600000066600005000000000050000000000
566666650833333008333330000000000006600044499999999994443bbbbbb33bbbbbbbbbbbbbbbbbbbbbb30666660000666660055506000060555000000000
566666650003333000033330000000000067760044499999999994443bbbbbb33bbbbbbbbbbbbbbbbbbbbbb36666500000056666005556600665550000000000
566666650033300000333000000000000067760044499999999994443bbbbbb33bbbbbbbbbbbbbbbbbbbbbb30665550000555660000566666666500000000000
366666630333000003330000000000000006600044499999999994443bbbbbb333bbbbbbbbbbbbbbbbbbbb330060555005550600006666600666660000000000
336666330333033303333300000000000000000044499999999994443bbbbbb3333bbbbbbbbbbbbbbbbbb3330000050000500000000666000066600000000000
33333333003333300033333300000000000000004449999999999444b333333b3333333333333333333333330000000000000000000060000006000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000dddd000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000055dd5500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000dddddd00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000ddeedd00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000ddeedd00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000dddddd00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000d0dd0d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0909190a19190819190819191909080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1919191919191919191919191919190000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
282928282a2a181a282829292a2a2a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1516071516071516070715160707070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1516071516071516070715160707070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1516171516171516171715161717170000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2116191516121520191915161919190000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
